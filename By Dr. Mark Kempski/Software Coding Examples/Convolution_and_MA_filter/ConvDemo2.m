%*****************************************************************************%DSP Short Course: E. R. Salem Associates%6/27/96%Program ConvDemo2.m%This program demonstrates the fold and slide interpretation of the%discrete convolution sum equation%*****************************************************************************%Define input, impulse response and related%******************************************clearn = [0 1 2 3 4 5 6];x = [1 2 3 2 1];h = [1 .5 .25];lenx = length(x);%Compute output via conv just so we can plot it initially%********************************************************y = conv(x,h);clffigure(gcf);subplot(3,1,1), stem(n,[x,0,0]), ylabel('input'), grid;subplot(3,1,2), stem(n,[h,0,0,0,0]), ylabel('imp resp'), grid;subplot(3,1,3), stem(n,y), ylabel('out via conv'), grid;pause%Now lets look at conv as fold and slide step by step; Define vectors%********************************************************************n = [-3 -2 -1 0 1 2 3 4 5 6 7 8];z = [ 0  0  0 0 0 0 0 0 0 0 0 0];x = [ 0  0  0 1 2 3 2 1 0 0 0 0];h = [1 .5 .25 0 0 0];%Compute output using another matlab conv function%*************************************************hmat = convmtx(h',length(x));y=hmat*x';%Plot the folding and sliding impulse responses and output%*********************************************************clffor i=1:12	subplot(3,1,1), stem(n,x), axis([-4 8 0 4]), ...	                grid, ylabel('input: x(n)');	subplot(3,1,2),stem(n,hmat(i,:)),axis([-4 8 0 2]), ...	                grid, ylabel('fold&shift h(n-k)');	zp=z;	zp(1:i)=y(1:i);	subplot(3,1,3),stem(n,zp), axis([-4 8 0 5]), ...	               grid, ylabel('output:y(n)');	pauseend