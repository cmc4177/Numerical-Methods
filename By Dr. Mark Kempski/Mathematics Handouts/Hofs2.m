%***********************************************************************%Hofs2.m%Based on Hofz.m by E. R. Salem	7/10/96  ; adapted by MH Kempski  2/11/02%This program demonstrates the plotting of the magnitude of an H(s)%function and then the evaluation of this H(s) function on the Im axis%  For simplicity, the function chosen is:%		H(s) = (1)/(s+1)%***********************************************************************%Initialize some things first%***************************clearclffigure(gcf)%Set up the x,y mesh grids%*************************thresh = 10;a=0.5001;X=-1:.02:1;Y=-1:.02:1;[x,y]=meshgrid(X,Y);%Form the complex z variable and compute H(z) and plot its magn%**************************************************************s=x+j*y;H=(1)./(s+a);magH=abs(H);angH=angle(H);w=find(magH>thresh);magH(w)=thresh*ones(size(w));%subplot(2,2,1),mesh(x,y,magH);mesh(x,y,magH);xlabel('Re axis X'); ylabel('Im axis Y'); zlabel('magH(s)');title('Plot of magH(s) vs. x and y');grid;pause%subplot(2,2,2), mesh(x,y,angH);mesh(x,y,angH);xlabel('Re axis X'); ylabel('Im axis Y'); zlabel('angH(z)');title('Plot of angH(s) vs. x and y');grid;pause%Evaluate H(s) on the Im axis giving H(s=(jw))%**************************************************%m=x.*x+y.*y;%f=(m > 1-.05 & m < 1+.05);m=x;f=(m > -0.05 & m < 0.05);fm=f.*magH;fa=f.*angH;%subplot(2,2,3),mesh(x,y,fm);mesh(x,y,fm);xlabel('X'); ylabel('Y'); zlabel('magH');title('Plot of magH(s) on Im axis vs. x and y');grid;pause%subplot(2,2,4),mesh(x,y,fa);mesh(x,y,fa);xlabel('X'); ylabel('Y'); zlabel('angH');title('Plot of angH(s) on Im axis vs. x and y');grid;